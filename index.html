<!DOCTYPE html>
<html>
<head>
    <title>Expense Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js" onerror="console.error('Failed to load Chart.js')"></script>
</head>
<body>

    <nav class="navbar" id="mainNavbar">
        <div class="nav-container">
            <div class="nav-left">
                <h1 class="nav-title" data-i18n="nav.title">Budgeting App</h1>
                <button type="button" id="obfuscateBtn" class="obfuscate-btn" data-i18n-title="common.obfuscate" title="Hide sensitive information">üëÅÔ∏è</button>
            </div>
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" onclick="navigateTo('home')" data-i18n="nav.home">Home</a></li>
                <li><a href="#" class="nav-link" onclick="navigateTo('recurring')" data-i18n="nav.recurring">Recurring</a></li>
                <li><a href="#" class="nav-link" onclick="navigateTo('charts')" data-i18n="nav.charts">Charts</a></li>
                <li><a href="#" class="nav-link" onclick="navigateTo('settings')" data-i18n="nav.settings">Settings</a></li>
            </ul>
        </div>
    </nav>

    <!-- Onboarding Flow -->
    <div id="onboardingPage" class="page active">
        <div class="onboarding-container">
            <!-- Theme Toggle for Onboarding -->
            <div class="onboarding-theme-toggle">
                <label class="toggle-switch">
                    <input type="checkbox" id="onboardingThemeToggle" onchange="toggleTheme(event)">
                    <span class="toggle-slider"></span>
                </label>
                <span class="onboarding-theme-label">
                    <span class="theme-icon">üåô</span>
                    <span class="theme-text" data-i18n="settings.darkmode">Dark Mode</span>
                </span>
            </div>
            
            <!-- Step 1: Welcome & Spreadsheet ID -->
            <div id="onboardingStep1" class="onboarding-step active">
                <div class="onboarding-content">
                    <h1 data-i18n="onboarding.welcome.title">Welcome to Budgeting App! üéØ</h1>
                    <p data-i18n="onboarding.welcome.subtitle">Let's set up your personalized budgeting experience in just a few steps.</p>
                    
                    <div style="margin: 20px 0; text-align: center;">
                        <button type="button" class="btn-primary" onclick="showAppFeaturesModal()" style="padding: 8px 16px; font-size: 14px;" data-i18n="onboarding.features.button">üìñ Learn About App Features</button>
                    </div>
                    
                    <div class="onboarding-form" style="max-width: 500px; margin: 0 auto;">
                        <label data-i18n="onboarding.step1.language" style="display: block; margin-bottom: 8px; font-weight: 500;">Language</label>
                        <select id="onboardingLanguage" onchange="I18n.setLanguage(this.value)" style="width: 100%; padding: 12px; margin-bottom: 25px; border: 2px solid var(--border-color); border-radius: 6px; font-size: 16px; background: var(--input-bg); color: var(--text-primary);">
                            <option value="en">English</option>
                            <option value="ro">Rom√¢nƒÉ</option>
                        </select>
                    </div>
                    
                    <div class="onboarding-form">
                        <h3 data-i18n="onboarding.step1.title">First, let's connect to your Google Spreadsheet</h3>
                        <p data-i18n="onboarding.step1.instructions">Go to <a href="https://sheets.google.com" target="_blank">Google Sheets</a>, create a new spreadsheet, and copy its ID from the URL.</p>
                        
                        <div class="example-box">
                            <strong data-i18n="onboarding.step1.example">Example URL:</strong><br>
                            <code>https://docs.google.com/spreadsheets/d/<span class="highlight">1oqS9MSo3XVw95jNPX-Lz0um-ookdlbM4uWzDtWyL3bU</span>/edit</code><br>
                            <small data-i18n="onboarding.step1.exampleNote">The highlighted part is your Spreadsheet ID</small>
                        </div>
                        
                        <label data-i18n="onboarding.step1.label">Your Spreadsheet ID *</label>
                        <input type="text" id="onboardingSpreadsheetId" data-i18n-placeholder="onboarding.step1.placeholder" placeholder="Paste your Spreadsheet ID here" required>
                        <small data-i18n="onboarding.step1.help">This will be used to connect your app to your spreadsheet</small>
                        
                        <button type="button" class="btn-primary" id="step1ContinueBtn" onclick="nextOnboardingStep()" disabled data-i18n="onboarding.step1.continue">Continue to Apps Script Setup ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Step 2: Apps Script Setup -->
            <div id="onboardingStep2" class="onboarding-step">
                <div class="onboarding-content">
                    <h2 data-i18n="onboarding.step2.title">Setup Apps Script üìä</h2>
                    <p data-i18n="onboarding.step2.subtitle">Now we'll set up the Google Apps Script to connect your spreadsheet to the app.</p>
                    
                    <div class="setup-tabs">
                        <button type="button" class="tab-btn active" onclick="showSetupTab('script')" data-i18n="onboarding.step2.tab1">
                            1. Copy & Deploy Script
                        </button>
                        <button type="button" class="tab-btn" onclick="showSetupTab('connect')" data-i18n="onboarding.step2.tab2">
                            2. Test Connection
                        </button>
                    </div>

                    <!-- Tab 1: Apps Script Setup -->
                    <div id="scriptTab" class="setup-tab active">
                        <div class="instruction-card">
                            <h3 data-i18n="onboarding.step2.scriptTitle">‚öôÔ∏è Step 1: Copy & Deploy Apps Script</h3>
                            <ol class="instruction-list">
                                <li data-i18n="onboarding.step2.instruction1">Go to <a href="https://script.google.com" target="_blank">Google Apps Script</a></li>
                                <li data-i18n="onboarding.step2.instruction2">Click "New project"</li>
                                <li data-i18n="onboarding.step2.instruction3">Replace the default code with the code below (it's already customized with your Spreadsheet ID!)</li>
                            </ol>
                            
                            <div class="code-container">
                                <div class="code-header">
                                    <span data-i18n="onboarding.step2.codeHeader">Apps Script Code (Personalized for Your Spreadsheet)</span>
                                    <button type="button" class="copy-btn" onclick="copyAppsScript()" data-i18n="onboarding.step2.copyCode">üìã Copy Code</button>
                                </div>
                                <textarea id="appsScriptCode" readonly class="code-textarea"></textarea>
                            </div>

                            <ol class="instruction-list" start="4">
                                <li data-i18n="onboarding.step2.instruction4">Paste the code into your Apps Script editor</li>
                                <li data-i18n="onboarding.step2.instruction5">Click "Save" (üíæ)</li>
                                <li data-i18n="onboarding.step2.instruction6">Click "Deploy" ‚Üí "New deployment"</li>
                                <li data-i18n="onboarding.step2.instruction7">Choose "Web app" as the type</li>
                                <li data-i18n="onboarding.step2.instruction8">Set "Execute as" to "Me"</li>
                                <li data-i18n="onboarding.step2.instruction9">Set "Who has access" to "Anyone"</li>
                                <li data-i18n="onboarding.step2.instruction10">Click "Deploy" and copy the Web App URL</li>
                            </ol>

                            <label data-i18n="onboarding.step2.scriptURL">Apps Script Web App URL:</label>
                            <input type="text" id="onboardingScriptURL" data-i18n-placeholder="onboarding.step2.scriptURLPlaceholder" placeholder="Paste your Web App URL here" required>
                            <small data-i18n="onboarding.step2.scriptURLHelp">Should look like: https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec</small>
                            
                            <button type="button" class="btn-primary tab-next" onclick="showSetupTab('connect')" disabled data-i18n="onboarding.step2.nextConnect">Next: Test Connection ‚Üí</button>
                        </div>
                    </div>

                    <!-- Tab 2: Connect -->
                    <div id="connectTab" class="setup-tab">
                        <div class="instruction-card">
                            <h3 data-i18n="onboarding.step2.testTitle">üîó Step 2: Test Connection</h3>
                            <p data-i18n="onboarding.step2.testSubtitle">Let's make sure everything is working correctly.</p>
                            
                            <div class="connection-status">
                                <div id="connectionTest" class="connection-result">
                                    <span data-i18n="onboarding.step2.testMessage">Click "Test Connection" to verify your setup</span>
                                </div>
                                <button type="button" class="btn-primary" onclick="testConnection()" data-i18n="onboarding.step2.testButton">üîç Test Connection</button>
                            </div>
                            
                            <div class="tab-buttons">
                                <button type="button" class="btn-secondary" onclick="showSetupTab('script')" data-i18n="onboarding.step2.back">‚Üê Back</button>
                                <button type="button" class="btn-primary" id="step2ContinueBtn" onclick="nextOnboardingStep()" disabled data-i18n="onboarding.step2.continue">Continue to Accounts ‚Üí</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Account Setup -->
            <div id="onboardingStep3" class="onboarding-step">
                <div class="onboarding-content">
                    <h2 data-i18n="onboarding.step3.title">Set Up Your Accounts üè¶</h2>
                    <p data-i18n="onboarding.step3.subtitle">Add the accounts you'll be tracking (checking, savings, credit cards, etc.)</p>
                    
                    <div class="accounts-section">
                        <div class="input-with-button">
                            <input type="text" id="newAccountName" data-i18n-placeholder="onboarding.step3.placeholder" placeholder="Account name (e.g., Checking)">
                            <button type="button" onclick="addAccount()" data-i18n="onboarding.step3.add">Add</button>
                        </div>
                        
                        <div id="accountsList" class="items-list">
                            <!-- Accounts will be added here dynamically -->
                        </div>
                    </div>
                    
                    <div class="onboarding-buttons">
                        <button type="button" class="btn-secondary" onclick="prevOnboardingStep()" data-i18n="onboarding.step3.back">Back</button>
                        <button type="button" class="btn-primary" id="step3ContinueBtn" onclick="nextOnboardingStep()" disabled data-i18n="onboarding.step3.continue">Continue</button>
                    </div>
                </div>
            </div>

            <!-- Step 4: Category Setup -->
            <div id="onboardingStep4" class="onboarding-step">
                <div class="onboarding-content">
                    <h2 data-i18n="onboarding.step4.title">Customize Categories üìù</h2>
                    <p data-i18n="onboarding.step4.subtitle">Modify or add expense categories that fit your spending habits.</p>
                    
                    <div class="categories-section">
                        <div class="input-with-button">
                            <input type="text" id="newCategoryName" data-i18n-placeholder="onboarding.step4.placeholder" placeholder="Category name (e.g., Entertainment)">
                            <button type="button" onclick="addCategory()" data-i18n="onboarding.step4.add">Add</button>
                        </div>
                        
                        <div id="categoriesList" class="items-list">
                            <!-- Categories will be loaded here dynamically -->
                        </div>
                    </div>
                    
                    <div class="onboarding-buttons">
                        <button type="button" class="btn-secondary" onclick="prevOnboardingStep()" data-i18n="onboarding.step4.back">Back</button>
                        <button type="button" class="btn-primary" id="step4ContinueBtn" onclick="nextOnboardingStep()" data-i18n="onboarding.step4.continue">Continue</button>
                    </div>
                </div>
            </div>

            <!-- Step 5: Personal Info & Completion -->
            <div id="onboardingStep5" class="onboarding-step">
                <div class="onboarding-content">
                    <h2 data-i18n="onboarding.step5.title">Almost Done! ‚ú®</h2>
                    <p data-i18n="onboarding.step5.subtitle">Just a few final details to personalize your experience.</p>
                    
                    <form id="personalInfoForm" class="onboarding-form">
                        <label data-i18n="onboarding.step5.name">Your Name (optional)</label>
                        <input type="text" id="onboardingUserName" data-i18n-placeholder="onboarding.step5.namePlaceholder" placeholder="How should we address you?">
                        
                        <label data-i18n="onboarding.step5.currency">Currency</label>
                        <select id="onboardingCurrency">
                            <option value="RON" selected>RON (lei)</option>
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (‚Ç¨)</option>
                            <option value="GBP">GBP (¬£)</option>
                            <option value="CAD">CAD ($)</option>
                            <option value="AUD">AUD ($)</option>
                        </select>
                        
                        <div class="onboarding-buttons">
                            <button type="button" class="btn-secondary" onclick="prevOnboardingStep()" data-i18n="onboarding.step5.back">Back</button>
                            <button type="button" class="btn-primary" onclick="completeOnboarding()" data-i18n="onboarding.step5.complete">Complete Setup</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Progress indicator -->
            <div class="onboarding-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text">
                    <span id="currentStep">1</span> <span data-i18n="onboarding.progress">of</span> <span id="totalSteps">5</span>
                </div>
            </div>
        </div>
    </div>

    <div id="homePage" class="page">
        <div class="header-container">
            <h2 class="header-title" data-i18n="home.title">New Transaction</h2>
        </div>
    <form id="trackerForm">
        <label data-i18n="form.amount">Amount *</label>
        <input type="number" id="amount" step="0.01" required>

        <label data-i18n="form.payee">Payee *</label>
        <input type="text" id="payee" list="payeeList" autocomplete="off">
        <datalist id="payeeList"></datalist>
        <div id="payeeSuggestions"></div>

        <label data-i18n="form.category">Category</label>
        <select id="category">
            <option selected>Childcare & School</option><option>Debt</option><option>Education</option>
            <option>Entertainment</option><option>Going out</option><option>Groceries</option>
            <option>Healthcare</option><option>Housing</option><option>Insurance</option>
            <option>Others</option><option>Personal Care</option><option>Savings & Investments</option>
            <option>Sport</option><option>Transportation</option><option>Utilities</option><option>Vacation</option>
            <option data-income-only="true" disabled style="display: none;">Account</option>
        </select>

        <label data-i18n="form.notes">Notes</label>
        <textarea id="notes" rows="3"></textarea>

        <label data-i18n="form.date">Date</label>
        <input type="date" id="date" required>

        <label data-i18n="form.dayOfWeek">Day of the Week</label>
        <input type="text" id="dayOfWeek" readonly>

        <label data-i18n="form.account">Account Used</label>
        <select id="account">
            <option>Ale</option>
            <option>Tavi</option>
        </select>

        <label data-i18n="form.type">Type</label>
        <select id="type">
            <option value="Expense" selected data-i18n="form.type.expense">Expense</option>
            <option value="Income" data-i18n="form.type.income">Income</option>
        </select>

        <div class="recurring-section">
            <div class="recurring-checkbox-container">
                <input type="checkbox" id="isRecurring" name="isRecurring">
                <label for="isRecurring" class="recurring-label" data-i18n="recurring.checkbox">üîÑ Make this a recurring transaction</label>
            </div>
            
            <div id="recurringOptions" class="recurring-options" style="display: none;">
                <div class="recurring-grid">
                    <div class="recurring-field">
                        <label data-i18n="recurring.frequency">Frequency *</label>
                        <select id="frequency">
                            <option value="" data-i18n="recurring.frequency.select">Select frequency</option>
                            <option value="daily" data-i18n="recurring.frequency.daily">Daily</option>
                            <option value="weekly" data-i18n="recurring.frequency.weekly">Weekly</option>
                            <option value="biweekly" data-i18n="recurring.frequency.biweekly">Bi-weekly</option>
                            <option value="monthly" data-i18n="recurring.frequency.monthly">Monthly</option>
                            <option value="quarterly" data-i18n="recurring.frequency.quarterly">Quarterly</option>
                            <option value="yearly" data-i18n="recurring.frequency.yearly">Yearly</option>
                        </select>
                    </div>

                    <div class="recurring-field">
                        <label data-i18n="recurring.startDate">Start Date</label>
                        <input type="date" id="recurringStartDate">
                    </div>

                    <div class="recurring-field">
                        <label data-i18n="recurring.endDate">End Date (Optional)</label>
                        <input type="date" id="recurringEndDate">
                    </div>

                    <div class="recurring-field">
                        <label data-i18n="recurring.nextDue">Next Due Date</label>
                        <input type="date" id="nextDueDate" readonly>
                    </div>
                </div>
                
                <div class="recurring-description">
                    <small id="recurringDescription" class="recurring-desc-text"></small>
                </div>
            </div>
        </div>

        <button type="submit" id="submitBtn" data-i18n="form.submit">Add Transaction</button>
    </form>

    <div id="successModal" class="success-modal">
        <div class="success-modal-content">
            <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="none" stroke="#28a745" stroke-width="4"/>
                <path d="M 30 50 L 45 65 L 70 35" fill="none" stroke="#28a745" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <p class="success-message" id="successMessage">Success! Transaction added!</p>
        </div>
    </div>

    <div class="transactions-container">
        <div class="transactions-header">
            <h2 data-i18n="transactions.title">Recent Transactions</h2>
            <button type="button" id="refreshBtn" class="refresh-btn" data-i18n-title="transactions.refresh" title="Refresh transactions">üîÑ</button>
        </div>
        <table class="transactions-table">
            <thead>
                <tr>
                    <th data-i18n="transactions.header.date">Date</th>
                    <th data-i18n="transactions.header.payee">Payee</th>
                    <th data-i18n="transactions.header.category">Category</th>
                    <th data-i18n="transactions.header.amount">Amount</th>
                    <th data-i18n="transactions.header.type">Type</th>
                    <th data-i18n="transactions.header.account">Account</th>
                    <th data-i18n="transactions.header.actions">Actions</th>
                </tr>
            </thead>
            <tbody id="transactionsBody">
                <tr><td colspan="7" style="text-align: center; color: #999;" data-i18n="transactions.loading">Loading transactions...</td></tr>
            </tbody>
        </table>
    </div>

    <button type="button" id="viewSpreadsheetBtn" onclick="openSpreadsheet()" class="view-spreadsheet-btn view-spreadsheet-bottom" data-i18n="settings.viewSpreadsheet">üìä View Spreadsheet</button>
    </div>

    <div id="recurringPage" class="page">
        <div class="header-container">
            <h2 class="header-title" data-i18n="recurring.title">Recurring Transactions</h2>
        </div>



        <div class="transactions-container">
            <div class="transactions-header">
                <h3 data-i18n="recurring.title">All Recurring Transactions</h3>
                <div style="display: flex; gap: 10px;">
                    <button type="button" id="refreshRecurringBtn" class="refresh-btn" onclick="refreshRecurringList()" data-i18n-title="transactions.refresh">üîÑ</button>
                </div>
            </div>
            <table class="transactions-table">
                <thead>
                    <tr>
                        <th data-i18n="recurring.table.payee">Payee</th>
                        <th data-i18n="transactions.header.category">Category</th>
                        <th data-i18n="recurring.table.amount">Amount</th>
                        <th data-i18n="transactions.header.type">Type</th>
                        <th data-i18n="recurring.table.frequency">Frequency</th>
                        <th data-i18n="recurring.table.nextDue">Next Due</th>
                        <th data-i18n="recurring.table.status">Status</th>
                        <th data-i18n="recurring.table.actions">Actions</th>
                    </tr>
                </thead>
                <tbody id="recurringTransactionsBody">
                    <tr><td colspan="8" style="text-align: center; color: #999;" data-i18n="transactions.loading">Loading recurring transactions...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="chartsPage" class="page">
        <div class="header-container">
            <h2 class="header-title" data-i18n="charts.title">Financial Charts</h2>
        </div>

        <div class="chart-filters">
            <div class="filter-dates">
                <div class="date-input-group">
                    <label data-i18n="charts.startDate">From</label>
                    <input type="date" id="chartStartDate">
                </div>
                <div class="date-input-group">
                    <label data-i18n="charts.endDate">To</label>
                    <input type="date" id="chartEndDate">
                </div>
            </div>

            <div class="quick-filters">
                <button type="button" id="todayBtn" class="quick-filter-btn" data-i18n="charts.period.day">Today</button>
                <button type="button" id="lastMonthBtn" class="quick-filter-btn" data-i18n="charts.lastMonth">Last Month</button>
                <button type="button" id="thisMonthBtn" class="quick-filter-btn" data-i18n="charts.thisMonth">This Month</button>
                <button type="button" id="thisYearBtn" class="quick-filter-btn" data-i18n="charts.thisYear">This Year</button>
            </div>

            <button type="button" id="applyFilterBtn" class="filter-btn" data-i18n="charts.applyFilter">Apply Filter</button>
            <button type="button" id="refreshChartsBtn" class="filter-btn" onclick="retryLoadCharts()" data-i18n="charts.refreshData">üîÑ Refresh Data</button>
        </div>

        <div class="charts-container">
            <div class="chart-wrapper">
                <h3 data-i18n="charts.expensesByCategory">Expenses by Category</h3>
                <canvas id="expensesCategoryChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <h3 data-i18n="charts.expensesVsIncome">Expenses vs Income</h3>
                <canvas id="expensesVsIncomeChart"></canvas>
            </div>
            <div class="chart-wrapper">
                <h3 data-i18n="charts.expensesByRank">Expenses by Category (Ranked)</h3>
                <canvas id="expensesCategoryBarChart"></canvas>
            </div>
        </div>
    </div>

    <div id="settingsPage" class="page">
        <div class="header-container">
            <h2 class="header-title" data-i18n="settings.title">Settings</h2>
        </div>
        
        <div class="settings-container">
            <div class="settings-section">
                <h3 data-i18n="settings.appearance">Appearance</h3>
                
                <div class="theme-toggle-container">
                    <div class="theme-toggle-label">
                        <span class="theme-icon">üåô</span>
                        <span data-i18n="settings.darkmode">Dark Mode</span>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="themeToggle" onchange="toggleTheme(event)">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="language-selector-container" style="margin-top: 20px;">
                    <label for="languageSelector" style="display: block; margin-bottom: 8px; font-weight: 500;" data-i18n="settings.language">Language</label>
                    <select id="languageSelector" onchange="changeLanguage(this.value)" style="width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--bg-color); color: var(--text-color);">
                        <option value="en">English</option>
                        <option value="ro">Rom√¢nƒÉ</option>
                    </select>
                </div>
            </div>

            <div class="settings-section">
                <h3 data-i18n="settings.configuration">Current Configuration</h3>
                <div class="config-display" id="configDisplay">
                    <!-- Configuration will be displayed here -->
                </div>
            </div>
            
            <div class="settings-section">
                <h3 data-i18n="settings.actions">Actions</h3>
                <div class="settings-actions">
                    <button type="button" class="btn-success" onclick="viewSpreadsheet()" data-i18n="settings.viewSpreadsheet">
                        üìä View Spreadsheet
                    </button>
                    <button type="button" class="btn-warning" onclick="showReconfigureModal()" data-i18n="settings.reconfigure">
                        üîÑ Reconfigure Settings
                    </button>
                    <button type="button" class="btn-danger" onclick="showResetModal()" data-i18n="settings.reset">
                        üóëÔ∏è Reset All Data
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirmation Modals -->
    <div id="appFeaturesModal" class="delete-modal">
        <div class="delete-modal-content" style="max-width: 700px; max-height: 85vh; overflow-y: auto;">
            <div class="delete-modal-header">
                <span class="delete-icon">üìñ</span>
                <h3 data-i18n="features.title">App Features Overview</h3>
            </div>
            <div class="modal-features-content">
                <h4 class="feature-heading" data-i18n="features.transactions.title">üí∞ Transaction Management</h4>
                <ul class="feature-list">
                    <li data-i18n="features.transactions.add"><strong>Add Transactions:</strong> Record income and expenses with details like payee, category, amount, and notes</li>
                    <li data-i18n="features.transactions.edit"><strong>Edit & Delete:</strong> Modify or remove transactions as needed</li>
                    <li data-i18n="features.transactions.accounts"><strong>Multiple Accounts:</strong> Track transactions across different accounts (bank, cash, credit cards)</li>
                    <li data-i18n="features.transactions.categories"><strong>Categories:</strong> Organize spending with customizable categories</li>
                </ul>

                <h4 class="feature-heading" data-i18n="features.recurring.title">üîÑ Recurring Transactions</h4>
                <ul class="feature-list">
                    <li data-i18n="features.recurring.automated"><strong>Automated Processing:</strong> Set up recurring income or expenses (daily, weekly, monthly, etc.)</li>
                    <li data-i18n="features.recurring.scheduling"><strong>Smart Scheduling:</strong> Transactions are automatically processed when due</li>
                    <li data-i18n="features.recurring.tracking"><strong>Status Tracking:</strong> Monitor active, inactive, overdue, and due transactions</li>
                    <li data-i18n="features.recurring.management"><strong>Flexible Management:</strong> Edit or delete recurring transactions anytime</li>
                </ul>

                <h4 class="feature-heading" data-i18n="features.analytics.title">üìä Analytics & Charts</h4>
                <ul class="feature-list">
                    <li data-i18n="features.analytics.overview"><strong>Spending Overview:</strong> Visual breakdown of expenses by category</li>
                    <li data-i18n="features.analytics.comparison"><strong>Income vs Expenses:</strong> Compare your income and spending patterns</li>
                    <li data-i18n="features.analytics.trends"><strong>Trend Analysis:</strong> Track financial trends over time</li>
                    <li data-i18n="features.analytics.periods"><strong>Period Selection:</strong> Analyze data by day, week, month, or custom date ranges</li>
                </ul>

                <h4 class="feature-heading" data-i18n="features.customization.title">‚öôÔ∏è Customization</h4>
                <ul class="feature-list">
                    <li data-i18n="features.customization.accounts"><strong>Custom Accounts:</strong> Add your own bank accounts, cards, or cash sources</li>
                    <li data-i18n="features.customization.categories"><strong>Custom Categories:</strong> Create categories that match your spending habits</li>
                    <li data-i18n="features.customization.currency"><strong>Currency Selection:</strong> Choose your preferred currency</li>
                    <li data-i18n="features.customization.privacy"><strong>Privacy Mode:</strong> Hide sensitive information with one click</li>
                </ul>

                <h4 class="feature-heading" data-i18n="features.cloud.title">‚òÅÔ∏è Cloud Sync</h4>
                <ul class="feature-list">
                    <li data-i18n="features.cloud.integration"><strong>Google Sheets Integration:</strong> All data stored securely in your own Google Spreadsheet</li>
                    <li data-i18n="features.cloud.sync"><strong>Real-time Sync:</strong> Changes are automatically saved to the cloud</li>
                    <li data-i18n="features.cloud.access"><strong>Access Anywhere:</strong> Your data is accessible from any device</li>
                    <li data-i18n="features.cloud.ownership"><strong>Data Ownership:</strong> You own and control all your financial data</li>
                </ul>

                <p class="feature-tip" data-i18n="features.tip">
                    <strong>üí° Tip:</strong> This app is designed to help you understand your spending patterns and make informed financial decisions!
                </p>
            </div>
            <div class="delete-modal-buttons">
                <button type="button" class="btn-primary" onclick="closeAppFeaturesModal()" data-i18n="features.close">Got it!</button>
            </div>
        </div>
    </div>

    <div id="reconfigureModal" class="delete-modal">
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <span class="delete-icon">üîÑ</span>
                <h3 data-i18n="reconfigure.title">Reconfigure Settings</h3>
            </div>
            <p class="delete-message" data-i18n="reconfigure.message">This will restart the setup process with your current settings prefilled. You can modify any settings you want to change.</p>
            <div class="delete-modal-buttons">
                <button type="button" class="btn-cancel" onclick="closeReconfigureModal()" data-i18n="reconfigure.cancel">Cancel</button>
                <button type="button" class="btn-warning" onclick="confirmReconfigure()" data-i18n="reconfigure.confirm">Reconfigure</button>
            </div>
        </div>
    </div>

    <div id="resetModal" class="delete-modal">
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <span class="delete-icon">‚ö†Ô∏è</span>
                <h3 data-i18n="reset.title">Reset All Data</h3>
            </div>
            <p class="delete-message" data-i18n="reset.message"><strong>Warning:</strong> This will permanently delete ALL your configuration, accounts, categories, and settings. This action cannot be undone.</p>
            <p style="color: #dc3545; font-weight: bold; margin-top: 10px;" data-i18n="reset.confirm.message">Are you absolutely sure you want to continue?</p>
            <div class="delete-modal-buttons">
                <button type="button" class="btn-cancel" onclick="closeResetModal()" data-i18n="reset.cancel">Cancel</button>
                <button type="button" class="btn-delete" onclick="confirmReset()" data-i18n="reset.confirm">Reset Everything</button>
            </div>
        </div>
    </div>

    <!-- Modals (outside page containers for global access) -->
    <div id="deleteModal" class="delete-modal">
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <span class="delete-icon">‚ö†Ô∏è</span>
                <h3 data-i18n="delete.title">Delete Transaction</h3>
            </div>
            <p class="delete-message" data-i18n="delete.message">Are you sure you want to delete this transaction? This action cannot be undone.</p>
            <div class="delete-transaction-details" id="deleteTransactionDetails"></div>
            <div class="delete-modal-buttons">
                <button type="button" class="btn-cancel" onclick="closeDeleteModal()" data-i18n="delete.cancel">Cancel</button>
                <button type="button" class="btn-delete" id="confirmDeleteBtn" onclick="handleDelete()" data-i18n="delete.confirm">Delete</button>
            </div>
        </div>
    </div>

    <div id="editModal" class="edit-modal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h3 data-i18n="edit.title">‚úèÔ∏è Edit Transaction</h3>
                <button type="button" class="edit-modal-close" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editTransactionForm">
                <input type="hidden" id="editRowIndex">
                
                <label data-i18n="form.amount">Amount *</label>
                <input type="number" id="editAmount" step="0.01" required>

                <label data-i18n="form.payee">Payee *</label>
                <input type="text" id="editPayee" required>

                <label data-i18n="form.category">Category</label>
                <select id="editCategory">
                    <option>Childcare & School</option><option>Debt</option><option>Education</option>
                    <option>Entertainment</option><option>Going out</option><option>Groceries</option>
                    <option>Healthcare</option><option>Housing</option><option>Insurance</option>
                    <option>Others</option><option>Personal Care</option><option>Savings & Investments</option>
                    <option>Sport</option><option>Transportation</option><option>Utilities</option><option>Vacation</option>
                    <option>Account</option>
                </select>

                <label data-i18n="form.notes">Notes</label>
                <textarea id="editNotes" rows="3"></textarea>

                <label data-i18n="form.date">Date</label>
                <input type="date" id="editDate" required>

                <label data-i18n="form.dayOfWeek">Day of the Week</label>
                <input type="text" id="editDayOfWeek" readonly>

                <label data-i18n="form.account">Account Used</label>
                <select id="editAccount">
                    <option>Ale</option>
                    <option>Tavi</option>
                </select>

                <label data-i18n="form.type">Type</label>
                <select id="editType">
                    <option value="Expense" data-i18n="form.type.expense">Expense</option>
                    <option value="Income" data-i18n="form.type.income">Income</option>
                </select>

                <div class="edit-modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeEditModal()" data-i18n="edit.cancel">Cancel</button>
                    <button type="submit" class="btn-save" id="saveEditBtn" data-i18n="edit.save">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Recurring Transaction Modals -->
    <div id="addRecurringModal" class="edit-modal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h3>‚ûï Add Recurring Transaction</h3>
                <button type="button" class="edit-modal-close" onclick="closeAddRecurringModal()">&times;</button>
            </div>
            <form id="addRecurringForm">
                <label>Amount *</label>
                <input type="number" id="recurringModalAmount" step="0.01" required>

                <label>Payee *</label>
                <input type="text" id="recurringModalPayee" required>

                <label>Category</label>
                <select id="recurringModalCategory">
                    <option>Childcare & School</option><option>Debt</option><option>Education</option>
                    <option>Entertainment</option><option>Going out</option><option>Groceries</option>
                    <option>Healthcare</option><option>Housing</option><option>Insurance</option>
                    <option>Others</option><option>Personal Care</option><option>Savings & Investments</option>
                    <option>Sport</option><option>Transportation</option><option>Utilities</option><option>Vacation</option>
                    <option>Account</option>
                </select>

                <label>Notes</label>
                <textarea id="recurringModalNotes" rows="2"></textarea>

                <label>Account Used</label>
                <select id="recurringModalAccount">
                    <option>Ale</option>
                    <option>Tavi</option>
                </select>

                <label>Type</label>
                <select id="recurringModalType">
                    <option value="Expense">Expense</option>
                    <option value="Income">Income</option>
                </select>

                <div class="recurring-options-modal">
                    <label>Frequency *</label>
                    <select id="recurringModalFrequency" required>
                        <option value="">Select frequency</option>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="biweekly">Bi-weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="yearly">Yearly</option>
                    </select>

                    <label>Start Date *</label>
                    <input type="date" id="recurringModalStartDate" required>

                    <label>End Date (Optional)</label>
                    <input type="date" id="recurringModalEndDate">
                </div>

                <div class="edit-modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeAddRecurringModal()">Cancel</button>
                    <button type="submit" class="btn-save">Create Recurring Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editRecurringModal" class="edit-modal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h3 data-i18n="editRecurring.title">‚úèÔ∏è Edit Recurring Transaction</h3>
                <button type="button" class="edit-modal-close" onclick="closeEditRecurringModal()">&times;</button>
            </div>
            <form id="editRecurringForm">
                <input type="hidden" id="editRecurringId">
                
                <label data-i18n="form.amount">Amount *</label>
                <input type="number" id="editRecurringAmount" step="0.01" required>

                <label data-i18n="form.payee">Payee *</label>
                <input type="text" id="editRecurringPayee" required>

                <label data-i18n="form.category">Category</label>
                <select id="editRecurringCategory">
                    <option>Childcare & School</option><option>Debt</option><option>Education</option>
                    <option>Entertainment</option><option>Going out</option><option>Groceries</option>
                    <option>Healthcare</option><option>Housing</option><option>Insurance</option>
                    <option>Others</option><option>Personal Care</option><option>Savings & Investments</option>
                    <option>Sport</option><option>Transportation</option><option>Utilities</option><option>Vacation</option>
                    <option>Account</option>
                </select>

                <label data-i18n="form.notes">Notes</label>
                <textarea id="editRecurringNotes" rows="2"></textarea>

                <label data-i18n="form.account">Account Used</label>
                <select id="editRecurringAccount">
                    <option>Ale</option>
                    <option>Tavi</option>
                </select>

                <label data-i18n="form.type">Type</label>
                <select id="editRecurringType">
                    <option value="Expense" data-i18n="form.type.expense">Expense</option>
                    <option value="Income" data-i18n="form.type.income">Income</option>
                </select>

                <div class="recurring-options-modal">
                    <label data-i18n="editRecurring.frequency">Frequency *</label>
                    <select id="editRecurringFrequency" required>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="biweekly">Bi-weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="yearly">Yearly</option>
                    </select>

                    <label data-i18n="editRecurring.startDate">Start Date *</label>
                    <input type="date" id="editRecurringStartDate" required>

                    <label data-i18n="editRecurring.endDate">End Date (Optional)</label>
                    <input type="date" id="editRecurringEndDate">

                    <label data-i18n="editRecurring.nextDue">Next Due Date</label>
                    <input type="date" id="editRecurringNextDue" required>
                </div>

                <div class="edit-modal-buttons">
                    <button type="button" class="btn-cancel" onclick="closeEditRecurringModal()" data-i18n="editRecurring.cancel">Cancel</button>
                    <button type="submit" class="btn-save" id="saveEditRecurringBtn" data-i18n="editRecurring.save">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Recurring Transaction Delete Modal -->
    <div id="deleteRecurringModal" class="delete-modal">
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <span class="delete-icon">‚ö†Ô∏è</span>
                <h3 data-i18n="deleteRecurring.title">Delete Recurring Transaction</h3>
            </div>
            <p class="delete-message" data-i18n="deleteRecurring.message">Are you sure you want to delete this recurring transaction? This will stop all future automatic transactions but won't affect already created transactions.</p>
            <div class="delete-transaction-details" id="deleteRecurringTransactionDetails"></div>
            <div class="delete-modal-buttons">
                <button type="button" class="btn-cancel" onclick="closeDeleteRecurringModal()" data-i18n="deleteRecurring.cancel">Cancel</button>
                <button type="button" class="btn-delete" id="confirmDeleteRecurringBtn" onclick="handleDeleteRecurring()" data-i18n="deleteRecurring.delete">Delete</button>
            </div>
        </div>
    </div>

    <!-- Load scripts in correct order -->
    <script src="js/translations.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/payee.js"></script>
    <script src="js/form.js"></script>
    <script src="js/transactions.js"></script>
    <script src="js/recurring.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/obfuscation.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/onboarding.js"></script>
    <script src="js/main.js"></script>
</body>
</html>